'''
Docstring for math_you_need_for_dl_code.flatten

class torch.nn.modules.flatten.Flatten(start_dim=1, end_dim=-1)
start_dim = first dim to flatten, end_dim = last dim to flatten

Flattens a contiguous range of dims into a tensor.

Once your CNN extracts features from image -> you flatten them into a vector before feeding them into a classifier.

Example
[
[1 2 3 4],
[5 6 7 8],
[9 10 11 12]
]

Shape: [3 matrices each of 2 rows 2 columns = 3,2,2]

After flatten it becomes [1,2,3,4,5,7,8,9,10,11,12] of shape [12] (scalar)

'''

import torch 

def main():
    input = torch.randn(32, 1, 5, 5) # 32 martices of 5*5
    print(f"Input shape: {input.size()}")
    flat = torch.nn.Flatten()
    output = flat(input)
    print(output)
    print(f"Output shape: {output.size()}")

main()

'''
Running through the output

Input shape: torch.Size([32, 1, 5, 5])
tensor([[[[-6.5768e-01,  2.2177e+00,  1.9912e+00, -9.6757e-01,  1.8781e+00],
          [-5.0159e-01, -5.9515e-01,  3.4042e-01, -3.7586e-01, -3.5107e-01],
          [-1.7602e-01, -1.2654e+00,  1.3151e+00, -3.8572e-01,  3.7673e-01],
          [ 1.5235e+00,  1.3644e-02,  1.8918e+00, -1.1987e+00,  1.5676e+00],
          [-1.9527e-01,  1.7529e+00,  1.2934e+00,  4.6343e-01,  5.2783e-01]]],


        [[[-1.4632e+00, -1.5177e+00,  9.7021e-01, -8.5234e-01, -1.0014e+00],
          [ 1.1903e-01, -1.1320e+00, -2.4021e-01, -3.5146e-01,  1.7695e-01],
          [-1.2510e+00,  6.4883e-01,  1.0475e+00, -3.7710e-01, -1.1414e+00],
          [-1.6029e-01,  1.1241e+00, -1.2636e+00, -1.0551e+00,  3.3167e-02],
          [-1.8087e-01,  2.0208e+00,  2.8791e-01, -5.0904e-01,  1.3336e+00]]],


        [[[-6.5434e-01, -5.5107e-01,  1.0928e+00,  1.2425e-01,  6.9079e-02],
          [-1.7274e+00, -5.3554e-01, -2.9910e-02,  1.9110e+00, -1.8931e+00],
          [ 1.2612e+00, -5.8554e-01,  3.1298e-01, -1.2716e+00, -1.1984e+00],
          [-3.9767e-01,  1.5272e+00,  5.3038e-01,  3.3731e-01,  6.8012e-01],
          [-1.4269e+00, -9.5716e-01, -1.6720e+00,  1.8738e-01, -1.1131e+00]]],
and so on.. (32 such matrices)


Output shape: torch.Size([32, 25])

tensor([[-1.2857e+00,  1.1503e+00,  4.9583e-01, -2.5369e-01,  8.1467e-01,
         -1.2984e+00,  5.5028e-01, -6.9410e-01,  9.1584e-01, -5.1560e-01,
          1.2473e+00,  5.9254e-02,  1.0891e+00, -4.9059e-01, -6.0608e-01,
         -1.0679e+00, -6.5677e-01,  1.9339e+00, -3.1266e-01, -1.6962e+00,
          9.1463e-01,  4.7116e-01, -1.1673e+00,  2.1021e-01,  3.7312e-01],
        [ 3.9016e-01, -2.6332e-01, -1.5894e-01, -1.8694e-01,  1.4070e+00,
         -2.7984e-01,  1.1422e+00, -6.6813e-01, -8.3553e-01, -4.0728e-01,
         -4.2755e-01,  9.8729e-01, -9.2860e-01, -4.8034e-01,  5.9902e-01,
         -2.4814e+00,  1.0799e+00,  5.5378e-01, -1.5339e-02,  1.9988e+00,
         -2.5685e+00, -7.9082e-01,  1.4877e-02, -5.8611e-01, -2.9204e-01],
        [ 1.8329e+00, -1.6608e+00, -7.4332e-01, -7.3267e-01,  2.8408e+00,
         -1.1096e-01, -1.5393e+00,  4.6376e-01,  1.2613e+00,  7.8451e-01,
          7.9930e-01, -1.3926e+00,  1.3647e+00, -1.2523e+00,  7.6175e-01,
         -7.6815e-01,  2.1351e-01, -7.1039e-01,  2.4744e+00, -1.1759e+00,
         -6.9889e-01, -3.0022e-01, -8.7697e-01,  1.8453e+00, -5.9701e-01],
        [-4.0956e-01,  8.8606e-01, -2.4208e-01,  9.8527e-01, -1.2055e+00,
         -5.8782e-01,  5.1786e-01, -1.4030e-02,  3.2171e-01, -3.8959e-02,
         -6.6270e-01,  3.0776e-01, -4.0734e-01, -1.1272e+00,  5.2005e-01,
         -3.2458e-01,  2.3852e-02, -1.8022e+00,  1.9157e+00, -3.1362e-01,
         -1.3613e-01,  1.3355e+00, -7.6222e-02, -1.5155e+00,  1.0318e-01],
        [ 1.7847e-01, -4.1577e-01,  1.8414e+00, -1.4217e+00,  2.6896e-01,
          2.4783e+00,  5.7502e-01,  5.1280e-01,  1.6085e+00,  7.3162e-01,
         -1.4077e+00,  1.3742e+00, -3.5392e-01,  2.0506e+00, -1.1221e+00,
          2.6050e-01, -1.4135e+00,  7.0458e-01, -1.3034e+00,  3.9550e-01,
          3.2107e-01,  4.7571e-01,  5.1955e-01,  5.6056e-01,  2.7905e-02],

1 matrix

What happens interally?
def flatten(x):
    return x.reshape(x.shape[0], -1)

Where is it used in production? CNN / ViT → Flatten → Linear → LLM adapter (like Multimodal sysmtes or classic ML (CNN))

'''
